{"remainingRequest":"/Users/zhaojiaming/Downloads/bbs_rectify/router/test/node_modules/babel-loader/lib/index.js!/Users/zhaojiaming/Downloads/bbs_rectify/router/test/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhaojiaming/Downloads/bbs_rectify/router/test/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhaojiaming/Downloads/bbs_rectify/router/test/src/views/changeAvatar.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhaojiaming/Downloads/bbs_rectify/router/test/src/views/changeAvatar.vue","mtime":1625727693000},{"path":"/Users/zhaojiaming/Downloads/bbs_rectify/router/test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaojiaming/Downloads/bbs_rectify/router/test/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhaojiaming/Downloads/bbs_rectify/router/test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaojiaming/Downloads/bbs_rectify/router/test/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy96aGFvamlhbWluZy9Eb3dubG9hZHMvYmJzX3JlY3RpZnkvcm91dGVyL3Rlc3Qvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyByZXF1ZXN0IH0gZnJvbSAnLi4vbmV0d29yay9yZXF1ZXN0JzsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VybmFtZTogbG9jYWxTdG9yYWdlLnVzZXJuYW1lLAogICAgICB1cmw6IGxvY2FsU3RvcmFnZS5hdmF0YXIKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgaW1nOiBmdW5jdGlvbiBpbWcoKSB7CiAgICAgIHJldHVybiByZXF1aXJlKCcuLi9hc3NldHMvJyArIHRoaXMudXJsKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHVwbG9hZEZpbGU6IGZ1bmN0aW9uIHVwbG9hZEZpbGUocGFyYW1zKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciB0aGF0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5pbWcgPSBwYXJhbXMuZmlsZS5uYW1lOwogICAgICAgICAgICAgICAgdGhhdCA9IF90aGlzOwogICAgICAgICAgICAgICAgcmVxdWVzdCh7CiAgICAgICAgICAgICAgICAgIG1ldGhvZDogInBvc3QiLAogICAgICAgICAgICAgICAgICB1cmw6ICIvY2hhbmdlQXZhdGFyIiwKICAgICAgICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB0aGF0LnVzZXJuYW1lLAogICAgICAgICAgICAgICAgICAgIGltZzogcGFyYW1zLmZpbGUubmFtZQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhID09ICJzdWNjZXNzIikgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCLmm7TmlLnmiJDlip8hIik7CiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmF2YXRhciA9IGxvY2FsU3RvcmFnZS5pbWc7CiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnN0YXRlID0gMDsKICAgICAgICAgICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5jbGVhcigpOwogICAgICAgICAgICAgICAgICAgIHRoYXQuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgIHBhdGg6ICJpbmRleCIKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwYXJhbXMuZmlsZS5uYW1lKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIGNoYW5nZVBpY3R1cmU6IGZ1bmN0aW9uIGNoYW5nZVBpY3R1cmUoKSB7CiAgICAgIGFsZXJ0KCLkv67mlLnlpLTlg48iKTsKICAgIH0sCiAgICBoYW5kbGVBdmF0YXJTdWNjZXNzOiBmdW5jdGlvbiBoYW5kbGVBdmF0YXJTdWNjZXNzKHJlcywgZmlsZSkgewogICAgICB0aGlzLmltYWdlVXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChmaWxlLnJhdyk7CiAgICB9LAogICAgYmVmb3JlQXZhdGFyVXBsb2FkOiBmdW5jdGlvbiBiZWZvcmVBdmF0YXJVcGxvYWQoZmlsZSkgewogICAgICB2YXIgaXNKUEcgPSBmaWxlLnR5cGUgPT09ICJpbWFnZS9qcGVnIjsKICAgICAgdmFyIGlzTHQyTSA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDwgMjsKCiAgICAgIGlmICghaXNKUEcpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLkuIrkvKDlpLTlg4/lm77niYflj6rog73mmK8gSlBHIOagvOW8jyEiKTsKICAgICAgfQoKICAgICAgaWYgKCFpc0x0Mk0pIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLkuIrkvKDlpLTlg4/lm77niYflpKflsI/kuI3og73otoXov4cgMk1CISIpOwogICAgICB9CgogICAgICByZXR1cm4gaXNKUEcgJiYgaXNMdDJNOwogICAgfSwKICAgIGJhY2s6IGZ1bmN0aW9uIGJhY2soKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBwYXRoOiAicGVyc29uYWwiCiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["changeAvatar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAqBA,SAAA,OAAA,QAAA,oBAAA;AACA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,QAAA,EAAA,YAAA,CAAA,QADA;AAEA,MAAA,GAAA,EAAA,YAAA,CAAA;AAFA,KAAA;AAIA,GANA;AAQA,EAAA,QAAA,EAAA;AACA,IAAA,GADA,iBACA;AACA,aAAA,OAAA,CAAA,eAAA,KAAA,GAAA,CAAA;AACA;AAHA,GARA;AAcA,EAAA,OAAA,EAAA;AACA,IAAA,UADA,sBACA,MADA,EACA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,gBAAA,YAAA,CAAA,GAAA,GAAA,MAAA,CAAA,IAAA,CAAA,IAAA;AACA,gBAAA,IAFA,GAEA,KAFA;AAGA,gBAAA,OAAA,CAAA;AACA,kBAAA,MAAA,EAAA,MADA;AAEA,kBAAA,GAAA,EAAA,eAFA;AAGA,kBAAA,IAAA,EAAA;AACA,oBAAA,QAAA,EAAA,IAAA,CAAA,QADA;AAEA,oBAAA,GAAA,EAAA,MAAA,CAAA,IAAA,CAAA;AAFA;AAHA,iBAAA,CAAA,CAOA,IAPA,CAOA,UAAA,GAAA,EAAA;AACA,sBAAA,GAAA,CAAA,IAAA,IAAA,SAAA,EAAA;AACA,oBAAA,KAAA,CAAA,OAAA,CAAA;AACA,oBAAA,YAAA,CAAA,MAAA,GAAA,YAAA,CAAA,GAAA;AACA,oBAAA,YAAA,CAAA,KAAA,GAAA,CAAA;AACA,oBAAA,cAAA,CAAA,KAAA;AACA,oBAAA,IAAA,CAAA,OAAA,CAAA,IAAA,CAAA;AACA,sBAAA,IAAA,EAAA;AADA,qBAAA;AAGA,oBAAA,QAAA,CAAA,MAAA;AACA;AACA,iBAlBA;AAmBA,gBAAA,OAAA,CAAA,GAAA,CAAA,MAAA,CAAA,IAAA,CAAA,IAAA;;AAtBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAuBA,KAxBA;AA0BA,IAAA,aA1BA,2BA0BA;AACA,MAAA,KAAA,CAAA,MAAA,CAAA;AACA,KA5BA;AA6BA,IAAA,mBA7BA,+BA6BA,GA7BA,EA6BA,IA7BA,EA6BA;AACA,WAAA,QAAA,GAAA,GAAA,CAAA,eAAA,CAAA,IAAA,CAAA,GAAA,CAAA;AACA,KA/BA;AAgCA,IAAA,kBAhCA,8BAgCA,IAhCA,EAgCA;AACA,UAAA,KAAA,GAAA,IAAA,CAAA,IAAA,KAAA,YAAA;AACA,UAAA,MAAA,GAAA,IAAA,CAAA,IAAA,GAAA,IAAA,GAAA,IAAA,GAAA,CAAA;;AAEA,UAAA,CAAA,KAAA,EAAA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,mBAAA;AACA;;AACA,UAAA,CAAA,MAAA,EAAA;AACA,aAAA,QAAA,CAAA,KAAA,CAAA,mBAAA;AACA;;AACA,aAAA,KAAA,IAAA,MAAA;AACA,KA3CA;AA4CA,IAAA,IA5CA,kBA4CA;AACA,WAAA,OAAA,CAAA,IAAA,CAAA;AACA,QAAA,IAAA,EAAA;AADA,OAAA;AAGA;AAhDA;AAdA,CAAA","sourcesContent":["<template>\r\n  <div style=\"margin: 20px\">\r\n    <el-upload\r\n      class=\"avatar-uploader\"\r\n      action=\"action\"\r\n      :show-file-list=\"false\"\r\n      :on-success=\"handleAvatarSuccess\"\r\n      :before-upload=\"beforeAvatarUpload\"\r\n      :http-request=\"uploadFile\"\r\n    >\r\n      <img v-if=\"img\" :src=\"img\" class=\"avatar\" />\r\n      <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n      <div slot=\"tip\" class=\"el-upload__tip\" style=\"margin: 30px\">\r\n        点击头像更改\r\n      </div>\r\n    </el-upload>\r\n    <el-button @click=\"back\">返回</el-button>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {request} from '../network/request'\r\nexport default {\r\n  data() {\r\n    return {\r\n      username: localStorage.username,\r\n      url: localStorage.avatar,\r\n    };\r\n  },\r\n  \r\n  computed: {\r\n        img () {\r\n            return require('../assets/'+this.url)\r\n        }\r\n  },\r\n\r\n  methods: {\r\n    async uploadFile(params) {\r\n      localStorage.img = params.file.name;\r\n      var that = this;\r\n      request({\r\n        method: \"post\",\r\n        url: \"/changeAvatar\",\r\n        data: {\r\n          username: that.username,\r\n          img: params.file.name,\r\n        },\r\n      }).then(function (res) {\r\n        if (res.data == \"success\") {\r\n          alert(\"更改成功!\");\r\n          localStorage.avatar = localStorage.img;\r\n          localStorage.state = 0;\r\n          sessionStorage.clear();\r\n          that.$router.push({\r\n            path: \"index\",\r\n          });\r\n          location.reload();\r\n        }\r\n      });\r\n      console.log(params.file.name);\r\n    },\r\n\r\n    changePicture() {\r\n      alert(\"修改头像\");\r\n    },\r\n    handleAvatarSuccess(res, file) {\r\n      this.imageUrl = URL.createObjectURL(file.raw);\r\n    },\r\n    beforeAvatarUpload(file) {\r\n      const isJPG = file.type === \"image/jpeg\";\r\n      const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n      if (!isJPG) {\r\n        this.$message.error(\"上传头像图片只能是 JPG 格式!\");\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error(\"上传头像图片大小不能超过 2MB!\");\r\n      }\r\n      return isJPG && isLt2M;\r\n    },\r\n    back() {\r\n      this.$router.push({\r\n        path: \"personal\",\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n\r\n\r\n<style>\r\n.bottom {\r\n  margin-top: 13px;\r\n  line-height: 12px;\r\n}\r\n\r\n.image {\r\n  width: 50%;\r\n  /* display: block; */\r\n}\r\n\r\n.clearfix:before,\r\n.clearfix:after {\r\n  display: table;\r\n  content: \"\";\r\n}\r\n\r\n.clearfix:after {\r\n  clear: both;\r\n}\r\n\r\n.avatar-uploader .el-upload {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n.avatar-uploader .el-upload:hover {\r\n  border-color: #409eff;\r\n}\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 178px;\r\n  height: 178px;\r\n  line-height: 178px;\r\n  text-align: center;\r\n}\r\n.avatar {\r\n  width: 178px;\r\n  height: 178px;\r\n  display: block;\r\n}\r\n</style>\r\n\r\n"],"sourceRoot":"src/views"}]}