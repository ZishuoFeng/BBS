{"remainingRequest":"/Users/zhaojiaming/Downloads/bbs_rectify/router/test/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhaojiaming/Downloads/bbs_rectify/router/test/src/views/changePass.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhaojiaming/Downloads/bbs_rectify/router/test/src/views/changePass.vue","mtime":1625729212000},{"path":"/Users/zhaojiaming/Downloads/bbs_rectify/router/test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaojiaming/Downloads/bbs_rectify/router/test/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhaojiaming/Downloads/bbs_rectify/router/test/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaojiaming/Downloads/bbs_rectify/router/test/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge3JlcXVlc3R9IGZyb20gJy4uL25ldHdvcmsvcmVxdWVzdCcNCmltcG9ydCBDcnlwdG8gZnJvbSAiQC9jcnlwdG8vaW5kZXguanMiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhKCkgew0KICAgIHZhciB2YWxpZGF0ZU9sZHBhc3MgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7DQogICAgICBpZiAodmFsdWUgPT09ICIiKSB7DQogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcigi6K+36L6T5YWl5pen5a+G56CBIikpOw0KICAgICAgfSBlbHNlIGlmICh2YWx1ZSAhPSBsb2NhbFN0b3JhZ2UucGFzc3dvcmQpIHsNCiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLor7fovpPlhaXmraPnoa7nmoTml6flr4bnoIEiKSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBjYWxsYmFjaygpOw0KICAgICAgfQ0KICAgIH07DQogICAgdmFyIHZhbGlkYXRlUGFzcyA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsNCiAgICAgIGlmICh2YWx1ZSA9PT0gIiIpIHsNCiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCLor7fovpPlhaXmlrDlr4bnoIEiKSk7DQogICAgICB9IGVsc2UgaWYgKHZhbHVlID09IGxvY2FsU3RvcmFnZS5wYXNzd29yZCkgew0KICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIuS4pOasoeWvhueggeS4jeiDveebuOWQjO+8gSIpKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGlmICh0aGlzLnJ1bGVGb3JtLmNoZWNrUGFzcyAhPT0gIiIpIHsNCiAgICAgICAgICB0aGlzLiRyZWZzLnJ1bGVGb3JtLnZhbGlkYXRlRmllbGQoImNoZWNrUGFzcyIpOw0KICAgICAgICB9DQogICAgICAgIGNhbGxiYWNrKCk7DQogICAgICB9DQogICAgfTsNCg0KICAgIHZhciB2YWxpZGF0ZVBhc3MyID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gew0KICAgICAgaWYgKHZhbHVlID09PSAiIikgew0KICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIuivt+WGjeasoei+k+WFpeaWsOWvhueggSIpKTsNCiAgICAgIH0gZWxzZSBpZiAodmFsdWUgIT09IHRoaXMucnVsZUZvcm0ucGFzcykgew0KICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoIuS4pOasoei+k+WFpeaWsOWvhueggeS4jeS4gOiHtCEiKSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBjYWxsYmFjaygpOw0KICAgICAgfQ0KICAgIH07DQogICAgcmV0dXJuIHsNCiAgICAgIHVzZXJuYW1lOiBsb2NhbFN0b3JhZ2UudXNlcm5hbWUsDQogICAgICBydWxlRm9ybTogew0KICAgICAgICBPbGRwYXNzOiBsb2NhbFN0b3JhZ2UucGFzc3dvcmQsDQogICAgICAgIHBhc3M6ICIiLA0KICAgICAgICBjaGVja1Bhc3M6ICIiLA0KICAgICAgfSwNCiAgICAgIHJ1bGVzOiB7DQogICAgICAgIE9sZHBhc3M6IFt7IHZhbGlkYXRvcjogdmFsaWRhdGVPbGRwYXNzLCB0cmlnZ2VyOiAiYmx1ciIgfV0sDQogICAgICAgIHBhc3M6IFt7IHZhbGlkYXRvcjogdmFsaWRhdGVQYXNzLCB0cmlnZ2VyOiAiYmx1ciIgfV0sDQogICAgICAgIGNoZWNrUGFzczogW3sgdmFsaWRhdG9yOiB2YWxpZGF0ZVBhc3MyLCB0cmlnZ2VyOiAiYmx1ciIgfV0sDQogICAgICB9LA0KICAgIH07DQogIH0sDQoNCiAgbWV0aG9kczogew0KICAgIHN1Ym1pdEZvcm0oKSB7DQogICAgICB2YXIgdGhhdCA9IHRoaXM7DQogICAgICByZXF1ZXN0KHsNCiAgICAgICAgbWV0aG9kOiAicG9zdCIsDQogICAgICAgIHVybDogIi9jaGFuZ2VQYXNzIiwNCiAgICAgICAgZGF0YTogew0KICAgICAgICAgIHVzZXJuYW1lOiBsb2NhbFN0b3JhZ2UudXNlcm5hbWUsDQogICAgICAgICAgcGFzc3dvcmQ6IENyeXB0by5zZXQodGhpcy5ydWxlRm9ybS5wYXNzKSwNCiAgICAgICAgfSwNCiAgICAgIH0pDQogICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHsNCiAgICAgICAgICBpZiAocmVzLmRhdGEgPT0gInN1Y2Nlc3MiKSB7DQogICAgICAgICAgICBsb2NhbFN0b3JhZ2UucGFzc3dvcmQgPSB0aGF0LnJ1bGVGb3JtLnBhc3M7DQogICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc3RhdGUgPSAwOw0KICAgICAgICAgICAgYWxlcnQoIuabtOaUueaIkOWKnyHor7fph43mlrDnmbvpmYYhIik7DQogICAgICAgICAgICB0aGF0LiRyb3V0ZXIucHVzaCh7DQogICAgICAgICAgICAgIHBhdGg6ICJsb2dpbiIsDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOw0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIHJlc2V0Rm9ybShmb3JtTmFtZSkgew0KICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0ucmVzZXRGaWVsZHMoKTsNCiAgICB9LA0KICAgIGJhY2soKSB7DQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7DQogICAgICAgIHBhdGg6ICJwZXJzb25hbCIsDQogICAgICB9KTsNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["changePass.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"changePass.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div style=\"margin: 20px\">\r\n    <el-form\r\n      :model=\"ruleForm\"\r\n      status-icon\r\n      :rules=\"rules\"\r\n      ref=\"ruleForm\"\r\n      label-width=\"100px\"\r\n      class=\"demo-ruleForm\"\r\n    >\r\n      <el-form-item label=\"用户名\">\r\n        {{ username }}\r\n      </el-form-item>\r\n      <el-form-item label=\"旧密码\" prop=\"Oldpass\">\r\n        <el-input\r\n          type=\"password\"\r\n          v-model=\"ruleForm.Oldpass\"\r\n          autocomplete=\"off\"\r\n        ></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"新密码\" prop=\"pass\">\r\n        <el-input\r\n          type=\"password\"\r\n          v-model=\"ruleForm.pass\"\r\n          autocomplete=\"off\"\r\n        ></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"确认密码\" prop=\"checkPass\">\r\n        <el-input\r\n          type=\"password\"\r\n          v-model=\"ruleForm.checkPass\"\r\n          autocomplete=\"off\"\r\n        ></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"submitForm('ruleForm')\"\r\n          >提交</el-button\r\n        >\r\n        <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\r\n        <el-button @click=\"back\">返回</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n\r\n\r\n<script>\r\nimport {request} from '../network/request'\r\nimport Crypto from \"@/crypto/index.js\";\r\nexport default {\r\n  data() {\r\n    var validateOldpass = (rule, value, callback) => {\r\n      if (value === \"\") {\r\n        callback(new Error(\"请输入旧密码\"));\r\n      } else if (value != localStorage.password) {\r\n        callback(new Error(\"请输入正确的旧密码\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    var validatePass = (rule, value, callback) => {\r\n      if (value === \"\") {\r\n        callback(new Error(\"请输入新密码\"));\r\n      } else if (value == localStorage.password) {\r\n        callback(new Error(\"两次密码不能相同！\"));\r\n      } else {\r\n        if (this.ruleForm.checkPass !== \"\") {\r\n          this.$refs.ruleForm.validateField(\"checkPass\");\r\n        }\r\n        callback();\r\n      }\r\n    };\r\n\r\n    var validatePass2 = (rule, value, callback) => {\r\n      if (value === \"\") {\r\n        callback(new Error(\"请再次输入新密码\"));\r\n      } else if (value !== this.ruleForm.pass) {\r\n        callback(new Error(\"两次输入新密码不一致!\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    return {\r\n      username: localStorage.username,\r\n      ruleForm: {\r\n        Oldpass: localStorage.password,\r\n        pass: \"\",\r\n        checkPass: \"\",\r\n      },\r\n      rules: {\r\n        Oldpass: [{ validator: validateOldpass, trigger: \"blur\" }],\r\n        pass: [{ validator: validatePass, trigger: \"blur\" }],\r\n        checkPass: [{ validator: validatePass2, trigger: \"blur\" }],\r\n      },\r\n    };\r\n  },\r\n\r\n  methods: {\r\n    submitForm() {\r\n      var that = this;\r\n      request({\r\n        method: \"post\",\r\n        url: \"/changePass\",\r\n        data: {\r\n          username: localStorage.username,\r\n          password: Crypto.set(this.ruleForm.pass),\r\n        },\r\n      })\r\n        .then(function (res) {\r\n          if (res.data == \"success\") {\r\n            localStorage.password = that.ruleForm.pass;\r\n            localStorage.state = 0;\r\n            alert(\"更改成功!请重新登陆!\");\r\n            that.$router.push({\r\n              path: \"login\",\r\n            });\r\n            location.reload();\r\n          }\r\n        })\r\n        .catch(function (err) {\r\n          console.log(err);\r\n        });\r\n    },\r\n    resetForm(formName) {\r\n      this.$refs[formName].resetFields();\r\n    },\r\n    back() {\r\n      this.$router.push({\r\n        path: \"personal\",\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n\r\n\r\n<style>\r\n.bottom {\r\n  margin-top: 13px;\r\n  line-height: 12px;\r\n}\r\n\r\n.image {\r\n  width: 50%;\r\n  /* display: block; */\r\n}\r\n\r\n.clearfix:before,\r\n.clearfix:after {\r\n  display: table;\r\n  content: \"\";\r\n}\r\n\r\n.clearfix:after {\r\n  clear: both;\r\n}\r\n\r\n.avatar-uploader .el-upload {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n.avatar-uploader .el-upload:hover {\r\n  border-color: #409eff;\r\n}\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 178px;\r\n  height: 178px;\r\n  line-height: 178px;\r\n  text-align: center;\r\n}\r\n.avatar {\r\n  width: 178px;\r\n  height: 178px;\r\n  display: block;\r\n}\r\n</style>\r\n\r\n"]}]}